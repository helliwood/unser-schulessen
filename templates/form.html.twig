{% use "bootstrap_4_layout.html.twig" %}

{%- block form_start -%}
    {% if not valid %}
        <div class="text-center my-2"><span class="badge badge-danger">Es befinden sich Fehler im Formular</span></div>
    {% endif %}
    {{ parent() }}
{%- endblock form_start -%}

{# Labels #}

{% block form_label -%}
    {%- if compound is defined and compound -%}
    {%- else -%}
        {%- set label_attr = label_attr|merge({class: (label_attr.class|default('') ~ ' ' ~ block('form_label_class'))|trim}) -%}
    {%- endif -%}
    {{- parent() -}}
{%- endblock form_label %}

{% block form_label_class -%}
    col-sm-3 col-form-label
{%- endblock form_label_class %}


{% block form_simple_label -%}
    {% if label is not same as(false) -%}
        {%- set label_attr = label_attr|merge({for: id}) -%}
        {%- set label_attr = label_attr|merge({class: (label_attr.class|default('') ~ ' ' ~ block('form_label_class'))|trim}) -%}
        {% if required -%}
            {% set label_attr = label_attr|merge({class: (label_attr.class|default('') ~ ' required')|trim}) %}
        {%- endif -%}
        {% if label is empty -%}
            {%- if label_format is not empty -%}
                {% set label = label_format|replace({
                    '%name%': name,
                    '%id%': id,
                }) %}
            {%- else -%}
                {% set label = name|humanize %}
            {%- endif -%}
        {%- endif -%}
        <{{ element|default('label') }}{% if label_attr %}{% with { attr: label_attr } %}{{ block('attributes') }}{% endwith %}{% endif %}>{{ translation_domain is same as(false) ? label : label|trans({}, translation_domain) }}</{{ element|default('label') }}>
    {%- else -%}
        {%- if errors|length > 0 -%}
            <div id="{{ id }}_errors" class="mb-2">
                {{- form_errors(form) -}}
            </div>
        {%- endif -%}
    {%- endif -%}
{%- endblock form_simple_label %}

{# Disable errors shown on form labels #}
{% block form_label_errors %}{% endblock form_label_errors %}

{# Rows #}

{% block form_row -%}
    {%- if compound is defined and compound -%}
        {{ block('fieldset_form_row') }}
    {%- else -%}
        {%- set widget_attr = {} -%}
        {%- if help is not empty -%}
            {%- set widget_attr = {attr: {'aria-describedby': id ~"_help"}} -%}
        {%- endif -%}
        <div class="form-group row{% if (not compound or force_error|default(false)) and not valid %} is-invalid{% endif %}">
            {{- form_label(form) -}}
            <div class="{{ block('form_group_class') }}">
                {{- form_widget(form, widget_attr) -}}
                {{- form_help(form) -}}
                {{- form_errors(form) -}}
            </div>
            {##}</div>
    {%- endif -%}
{%- endblock form_row %}

{% block choice_row -%}
    {%- set widget_attr = {} -%}
    {%- if help is not empty -%}
        {%- set widget_attr = {attr: {'aria-describedby': id ~"_help"}} -%}
    {%- endif -%}
    <div class="form-group row{% if (not compound or force_error|default(false)) and not valid %} is-invalid{% endif %}">
        {{- block('form_simple_label') -}}
        <div class="{{ block('form_group_class') }}">
            {{- form_widget(form, widget_attr) -}}
            {{- form_help(form) -}}
            {{- form_errors(form) -}}
        </div>
        {##}</div>
{%- endblock choice_row %}

{%- block radio_widget -%}
    {%- if attr and attr.readonly -%}
        {% set attr = attr|merge({disabled: "disabled"}) %}
    {%- endif -%}
    {{- parent() -}}
{%- endblock radio_widget -%}

{%- block checkbox_widget -%}
    {%- if attr and attr.readonly -%}
        {% set attr = attr|merge({disabled: "disabled"}) %}
    {%- endif -%}
    {{- parent() -}}
{%- endblock checkbox_widget -%}

{% block fieldset_form_row -%}
    {%- if help is not empty -%}
        {%- set widget_attr = {attr: {'aria-describedby': id ~"_help"}} -%}
    {%- endif -%}
    <fieldset class="form-group" {{ block('widget_container_attributes') }}>
        {{- form_label(form) -}}
        <div class="row{% if (not compound or force_error|default(false)) and not valid %} is-invalid{% endif %}">
            {%- set widget_attr = {attr:{'class':attr.class|default('col-12'), style:""}} -%}
            {{- form_widget(form, widget_attr) -}}
            {{- form_help(form) -}}
        </div>
    </fieldset>
{%- endblock fieldset_form_row %}

{% block date_row -%}
    {%- set widget_attr = {} -%}
    {%- if help is not empty -%}
        {%- set widget_attr = {attr: {'aria-describedby': id ~"_help"}} -%}
    {%- endif -%}
    <div class="form-group row{% if (not compound or force_error|default(false)) and not valid %} is-invalid{% endif %}">
        {{- block('form_simple_label') -}}
        <div class="{{ block('form_group_class') }}">
            {{- form_widget(form, widget_attr) -}}
            {{- form_help(form) -}}
            {{- form_errors(form) -}}
        </div>
        {##}</div>
{%- endblock date_row %}

{% block date_widget -%}
    {%- if widget != 'single_text' and not valid -%}
        {% set attr = attr|merge({class: (attr.class|default('') ~ ' is-invalid')|trim}) -%}
        {% set valid = true %}
    {%- endif -%}
    {{- parent() -}}
{%- endblock date_widget %}

{% block time_row -%}
    {%- set widget_attr = {} -%}
    {%- if help is not empty -%}
        {%- set widget_attr = {attr: {'aria-describedby': id ~"_help"}} -%}
    {%- endif -%}
    <div class="form-group row{% if (not compound or force_error|default(false)) and not valid %} is-invalid{% endif %}">
        {{- block('form_simple_label') -}}
        <div class="{{ block('form_group_class') }}">
            {{- form_widget(form, widget_attr) -}}
            {{- form_help(form) -}}
            {{- form_errors(form) -}}
        </div>
        {##}</div>
{%- endblock time_row %}

{% block submit_row -%}
    <div class="form-group row">{#--#}
        <div class="{{ block('form_label_class') }}"></div>{#--#}
        <div class="{{ block('form_group_class') }}">
            {{- form_widget(form) -}}
        </div>{#--#}
    </div>
{%- endblock submit_row %}

{% block reset_row -%}
    <div class="form-group row">{#--#}
        <div class="{{ block('form_label_class') }}"></div>{#--#}
        <div class="{{ block('form_group_class') }}">
            {{- form_widget(form) -}}
        </div>{#--#}
    </div>
{%- endblock reset_row %}

{% block form_group_class -%}
    col-sm-9
{%- endblock form_group_class %}

{% block checkbox_row -%}
    <div class="form-group row">{#--#}
        <div class="{{ block('form_label_class') }}"></div>{#--#}
        <div class="{{ block('form_group_class') }}">
            {{- form_widget(form) -}}
            {{- form_help(form) -}}
        </div>{#--#}
    </div>
{%- endblock checkbox_row %}

{# Class zu jedem select #}
{% block choice_widget_collapsed -%}
    {%- set attr = attr|merge({class: (attr.class|default('') ~ ' custom-select')|trim}) -%}
    {{- parent() -}}
{%- endblock choice_widget_collapsed %}
{#
{% block date_widget -%}
    <div class="input-group date mydatetime" id="{{ id }}_picker" data-target-input="nearest">
        {%- set attr = attr|merge({class: (attr.class|default('') ~ ' datetimepicker-input')|trim, "data-target": '#' ~ id ~ '_picker'}) -%}
        {{- parent() -}}
        <div class="input-group-append" data-target="#{{ id }}_picker" data-toggle="datetimepicker">
            <div class="input-group-text"><i class="fa fa-calendar"></i></div>
        </div>
    </div>
{%- endblock date_widget %}
#}
{% block money_widget -%}
    {%- set prepend = not (money_pattern starts with '{{') -%}
    {%- set append = not (money_pattern ends with '}}') -%}
    {%- if prepend or append -%}
        <div class="input-group" style="width: 150px;">
            {%- if prepend -%}
                <div class="input-group-prepend">
                    <span class="input-group-text">{{ money_pattern|form_encode_currency }}</span>
                </div>
            {%- endif -%}
            {{- block('form_widget_simple') -}}
            {%- if append -%}
                <div class="input-group-append">
                    <span class="input-group-text">{{ money_pattern|form_encode_currency }}</span>
                </div>
            {%- endif -%}
        </div>
    {%- else -%}
        {{- block('form_widget_simple') -}}
    {%- endif -%}
{%- endblock money_widget %}

{% block time_widget -%}
    {%- if widget != 'single_text' and not valid -%}
        {% set attr = attr|merge({class: (attr.class|default('') ~ ' is-invalid')|trim}) -%}
        {% set valid = true %}
    {%- endif -%}
    {{- parent() -}}
{%- endblock time_widget %}

{% block datetime_widget -%}
    <form-date-time name="{{ full_name }}" :disabled="{{ disabled ? 'true' : 'false' }}" value="{{ value }}"></form-date-time>
    {{- form_help(form) -}}
    {{- form_errors(form) -}}

{%- endblock datetime_widget %}

{%- block textarea_widget -%}
    {%- set attr = attr|merge({"@input": "textareaChange"}) -%}
    {{- parent() -}}
{%- endblock textarea_widget -%}
